# 版权信息© 2025代码生成文档

## 概述
本文档提供了在不同平台和框架中实现动态版权年份计算的完整代码示例，支持自动年份范围计算和手动年份设置。

## 功能特性
- 自动计算版权年份范围
- 支持手动设置开始年份
- 跨平台兼容（Vue、React、原生JS、PHP等）
- 响应式年份更新

---

## 1. Vue 3 + TypeScript 项目

### 1.1 配置接口定义
```typescript
// src/utils/configLoader.ts
export interface CopyrightConfig {
  startDate: string  // 格式：YYYY-MM-DD
  autoRange: boolean // 是否自动计算年份范围
}

export interface AppConfig {
  copyright: CopyrightConfig
  // ... 其他配置
}
```

### 1.2 年份计算函数
```typescript
// src/utils/configLoader.ts
export function formatCopyrightYear(copyrightConfig: CopyrightConfig): string {
  if (!copyrightConfig.autoRange) {
    // 如果禁用自动范围，只显示开始年份
    return copyrightConfig.startDate.split('-')[0]
  }

  try {
    const startDate = new Date(copyrightConfig.startDate)
    const currentDate = new Date()
    
    const startYear = startDate.getFullYear()
    const currentYear = currentDate.getFullYear()
    
    // 计算年份差
    const yearDiff = currentYear - startYear
    
    if (yearDiff <= 0) {
      // 当前年份小于等于开始年份，只显示开始年份
      return startYear.toString()
    } else if (yearDiff >= 1) {
      // 超过一年，显示年份范围
      return `${startYear}-${currentYear}`
    } else {
      // 不到一年，只显示开始年份
      return startYear.toString()
    }
  } catch (error) {
    console.error('版权年份格式化错误:', error)
    // 出错时返回开始年份
    return copyrightConfig.startDate.split('-')[0]
  }
}
```

### 1.3 Vue 组件使用
```vue
<!-- src/views/HomeView.vue -->
<template>
  <footer class="app-footer">
    <div class="footer-content">
      Copyright © {{ copyrightYear }} 
      <a :href="appConfigRef.footer.websiteUrl" target="_blank" class="footer-link">
        {{ appConfigRef.footer.websiteText }}
      </a> 
      • Powered by 
      <a :href="appConfigRef.footer.authorUrl" target="_blank" class="footer-link">
        {{ appConfigRef.footer.authorText }}
      </a>
    </div>
  </footer>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import { appConfig, formatCopyrightYear } from '@/utils/configLoader'

// 版权年份
const copyrightYear = computed(() => {
  return formatCopyrightYear(appConfig.copyright)
})
</script>
```

### 1.4 配置文件示例
```yaml
# config.yml
copyright:
  startDate: "2025-01-01"
  autoRange: true
```

---

## 2. React + TypeScript 项目

### 2.1 类型定义
```typescript
// types/config.ts
export interface CopyrightConfig {
  startDate: string
  autoRange: boolean
}

export interface AppConfig {
  copyright: CopyrightConfig
}
```

### 2.2 年份计算 Hook
```typescript
// hooks/useCopyright.ts
import { useMemo } from 'react'

export function useCopyright(config: CopyrightConfig): string {
  return useMemo(() => {
    if (!config.autoRange) {
      return config.startDate.split('-')[0]
    }

    try {
      const startDate = new Date(config.startDate)
      const currentDate = new Date()
      
      const startYear = startDate.getFullYear()
      const currentYear = currentDate.getFullYear()
      const yearDiff = currentYear - startYear
      
      if (yearDiff <= 0) {
        return startYear.toString()
      } else if (yearDiff >= 1) {
        return `${startYear}-${currentYear}`
      } else {
        return startYear.toString()
      }
    } catch (error) {
      console.error('版权年份计算错误:', error)
      return config.startDate.split('-')[0]
    }
  }, [config.startDate, config.autoRange])
}
```

### 2.3 React 组件使用
```tsx
// components/Footer.tsx
import React from 'react'
import { useCopyright } from '../hooks/useCopyright'

interface FooterProps {
  config: {
    copyright: CopyrightConfig
    footer: {
      websiteText: string
      websiteUrl: string
      authorText: string
      authorUrl: string
    }
  }
}

export const Footer: React.FC<FooterProps> = ({ config }) => {
  const copyrightYear = useCopyright(config.copyright)

  return (
    <footer className="app-footer">
      <div className="footer-content">
        Copyright © {copyrightYear} 
        <a href={config.footer.websiteUrl} target="_blank" className="footer-link">
          {config.footer.websiteText}
        </a> 
        • Powered by 
        <a href={config.footer.authorUrl} target="_blank" className="footer-link">
          {config.footer.authorText}
        </a>
      </div>
    </footer>
  )
}
```

---

## 3. 原生 JavaScript 项目

### 3.1 年份计算函数
```javascript
// js/copyright.js
class CopyrightManager {
  constructor(config) {
    this.config = config
  }

  formatCopyrightYear() {
    if (!this.config.autoRange) {
      return this.config.startDate.split('-')[0]
    }

    try {
      const startDate = new Date(this.config.startDate)
      const currentDate = new Date()
      
      const startYear = startDate.getFullYear()
      const currentYear = currentDate.getFullYear()
      const yearDiff = currentYear - startYear
      
      if (yearDiff <= 0) {
        return startYear.toString()
      } else if (yearDiff >= 1) {
        return `${startYear}-${currentYear}`
      } else {
        return startYear.toString()
      }
    } catch (error) {
      console.error('版权年份计算错误:', error)
      return this.config.startDate.split('-')[0]
    }
  }

  updateCopyrightElement(elementId) {
    const element = document.getElementById(elementId)
    if (element) {
      element.textContent = `Copyright © ${this.formatCopyrightYear()}`
    }
  }

  // 自动更新版权年份（每年更新一次）
  startAutoUpdate(elementId) {
    this.updateCopyrightElement(elementId)
    
    // 计算到明年1月1日的时间
    const now = new Date()
    const nextYear = new Date(now.getFullYear() + 1, 0, 1)
    const timeUntilNextYear = nextYear.getTime() - now.getTime()
    
    setTimeout(() => {
      this.updateCopyrightElement(elementId)
      this.startAutoUpdate(elementId) // 递归调用
    }, timeUntilNextYear)
  }
}

// 使用示例
const copyrightConfig = {
  startDate: "2025-01-01",
  autoRange: true
}

const copyrightManager = new CopyrightManager(copyrightConfig)

// 页面加载完成后更新版权信息
document.addEventListener('DOMContentLoaded', function() {
  copyrightManager.updateCopyrightElement('copyright-year')
  
  // 如果需要自动更新
  copyrightManager.startAutoUpdate('copyright-year')
})
```

### 3.2 HTML 使用示例
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Panel</title>
</head>
<body>
    <!-- 页面内容 -->
    
    <footer class="app-footer">
        <div class="footer-content">
            <span id="copyright-year">Copyright © 2025</span>
            <a href="https://website.gw124.top" target="_blank" class="footer-link">
                WEBSITE.GW124.TOP
            </a> 
            • Powered by 
            <a href="https://github.com/GWen124" target="_blank" class="footer-link">
                Wen
            </a>
        </div>
    </footer>

    <script src="js/copyright.js"></script>
</body>
</html>
```

---

## 4. PHP 项目

### 4.1 版权年份计算类
```php
<?php
// classes/CopyrightManager.php
class CopyrightManager {
    private $startDate;
    private $autoRange;

    public function __construct($startDate, $autoRange = true) {
        $this->startDate = $startDate;
        $this->autoRange = $autoRange;
    }

    public function getCopyrightYear() {
        if (!$this->autoRange) {
            return date('Y', strtotime($this->startDate));
        }

        try {
            $startYear = date('Y', strtotime($this->startDate));
            $currentYear = date('Y');
            $yearDiff = $currentYear - $startYear;

            if ($yearDiff <= 0) {
                return $startYear;
            } elseif ($yearDiff >= 1) {
                return $startYear . '-' . $currentYear;
            } else {
                return $startYear;
            }
        } catch (Exception $e) {
            error_log('版权年份计算错误: ' . $e->getMessage());
            return date('Y', strtotime($this->startDate));
        }
    }

    public function getCopyrightText($websiteText, $websiteUrl, $authorText, $authorUrl) {
        $copyrightYear = $this->getCopyrightYear();
        
        return sprintf(
            'Copyright © %s <a href="%s" target="_blank" class="footer-link">%s</a> • Powered by <a href="%s" target="_blank" class="footer-link">%s</a>',
            $copyrightYear,
            htmlspecialchars($websiteUrl),
            htmlspecialchars($websiteText),
            htmlspecialchars($authorUrl),
            htmlspecialchars($authorText)
        );
    }
}
?>
```

### 4.2 配置文件
```php
<?php
// config/copyright.php
return [
    'startDate' => '2025-01-01',
    'autoRange' => true,
    'footer' => [
        'websiteText' => 'WEBSITE.GW124.TOP',
        'websiteUrl' => 'https://website.gw124.top',
        'authorText' => 'Wen',
        'authorUrl' => 'https://github.com/GWen124'
    ]
];
?>
```

### 4.3 使用示例
```php
<?php
// index.php
require_once 'classes/CopyrightManager.php';
$config = require 'config/copyright.php';

$copyrightManager = new CopyrightManager(
    $config['startDate'], 
    $config['autoRange']
);
?>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Panel</title>
</head>
<body>
    <!-- 页面内容 -->
    
    <footer class="app-footer">
        <div class="footer-content">
            <?php echo $copyrightManager->getCopyrightText(
                $config['footer']['websiteText'],
                $config['footer']['websiteUrl'],
                $config['footer']['authorText'],
                $config['footer']['authorUrl']
            ); ?>
        </div>
    </footer>
</body>
</html>
```

---

## 5. Node.js + Express 项目

### 5.1 版权管理器
```javascript
// utils/copyrightManager.js
class CopyrightManager {
  constructor(config) {
    this.startDate = config.startDate
    this.autoRange = config.autoRange
  }

  getCopyrightYear() {
    if (!this.autoRange) {
      return new Date(this.startDate).getFullYear().toString()
    }

    try {
      const startYear = new Date(this.startDate).getFullYear()
      const currentYear = new Date().getFullYear()
      const yearDiff = currentYear - startYear

      if (yearDiff <= 0) {
        return startYear.toString()
      } else if (yearDiff >= 1) {
        return `${startYear}-${currentYear}`
      } else {
        return startYear.toString()
      }
    } catch (error) {
      console.error('版权年份计算错误:', error)
      return new Date(this.startDate).getFullYear().toString()
    }
  }

  getCopyrightHTML(websiteText, websiteUrl, authorText, authorUrl) {
    const copyrightYear = this.getCopyrightYear()
    
    return `Copyright © ${copyrightYear} <a href="${websiteUrl}" target="_blank" class="footer-link">${websiteText}</a> • Powered by <a href="${authorUrl}" target="_blank" class="footer-link">${authorText}</a>`
  }
}

module.exports = CopyrightManager
```

### 5.2 Express 路由使用
```javascript
// routes/index.js
const express = require('express')
const CopyrightManager = require('../utils/copyrightManager')

const router = express.Router()

const config = {
  startDate: '2025-01-01',
  autoRange: true,
  footer: {
    websiteText: 'WEBSITE.GW124.TOP',
    websiteUrl: 'https://website.gw124.top',
    authorText: 'Wen',
    authorUrl: 'https://github.com/GWen124'
  }
}

router.get('/', (req, res) => {
  const copyrightManager = new CopyrightManager(config)
  const copyrightHTML = copyrightManager.getCopyrightHTML(
    config.footer.websiteText,
    config.footer.websiteUrl,
    config.footer.authorText,
    config.footer.authorUrl
  )

  res.render('index', {
    title: 'Website Panel',
    copyright: copyrightHTML
  })
})

module.exports = router
```

### 5.3 EJS 模板
```html
<!-- views/index.ejs -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
</head>
<body>
    <!-- 页面内容 -->
    
    <footer class="app-footer">
        <div class="footer-content">
            <%- copyright %>
        </div>
    </footer>
</body>
</html>
```

---

## 6. Python + Flask 项目

### 6.1 版权管理器
```python
# utils/copyright_manager.py
from datetime import datetime
import logging

class CopyrightManager:
    def __init__(self, start_date, auto_range=True):
        self.start_date = start_date
        self.auto_range = auto_range

    def get_copyright_year(self):
        if not self.auto_range:
            return datetime.strptime(self.start_date, '%Y-%m-%d').year

        try:
            start_year = datetime.strptime(self.start_date, '%Y-%m-%d').year
            current_year = datetime.now().year
            year_diff = current_year - start_year

            if year_diff <= 0:
                return start_year
            elif year_diff >= 1:
                return f"{start_year}-{current_year}"
            else:
                return start_year
        except Exception as e:
            logging.error(f'版权年份计算错误: {e}')
            return datetime.strptime(self.start_date, '%Y-%m-%d').year

    def get_copyright_html(self, website_text, website_url, author_text, author_url):
        copyright_year = self.get_copyright_year()
        
        return f'Copyright © {copyright_year} <a href="{website_url}" target="_blank" class="footer-link">{website_text}</a> • Powered by <a href="{author_url}" target="_blank" class="footer-link">{author_text}</a>'
```

### 6.2 Flask 应用
```python
# app.py
from flask import Flask, render_template
from utils.copyright_manager import CopyrightManager

app = Flask(__name__)

config = {
    'startDate': '2025-01-01',
    'autoRange': True,
    'footer': {
        'websiteText': 'WEBSITE.GW124.TOP',
        'websiteUrl': 'https://website.gw124.top',
        'authorText': 'Wen',
        'authorUrl': 'https://github.com/GWen124'
    }
}

@app.route('/')
def index():
    copyright_manager = CopyrightManager(config['startDate'], config['autoRange'])
    copyright_html = copyright_manager.get_copyright_html(
        config['footer']['websiteText'],
        config['footer']['websiteUrl'],
        config['footer']['authorText'],
        config['footer']['authorUrl']
    )

    return render_template('index.html', 
                          title='Website Panel',
                          copyright=copyright_html)

if __name__ == '__main__':
    app.run(debug=True)
```

### 6.3 Jinja2 模板
```html
<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
</head>
<body>
    <!-- 页面内容 -->
    
    <footer class="app-footer">
        <div class="footer-content">
            {{ copyright|safe }}
        </div>
    </footer>
</body>
</html>
```

---

## 7. CSS 样式示例

### 7.1 基础样式
```css
/* styles/footer.css */
.app-footer {
  background: transparent;
  padding: 24px 0;
  margin-top: 48px;
  position: relative;
}

.app-footer::before {
  content: '';
  position: absolute;
  top: 0;
  left: 50%;
  width: 85%;
  height: 1px;
  background: linear-gradient(to right, transparent 0%, #e5e5e5 20%, #e5e5e5 80%, transparent 100%);
  transform: translateX(-50%);
}

.footer-content {
  max-width: 80vw;
  margin: 0 auto;
  padding: 0 24px;
  text-align: center;
  color: #000000;
  font-size: 1rem;
}

.footer-link {
  color: #000000;
  text-decoration: none;
  position: relative;
  transition: color 0.2s ease;
  font-weight: 600;
}

.footer-link::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 50%;
  width: 0;
  height: 1px;
  background-color: currentColor;
  transition: all 0.3s ease;
  transform: translateX(-50%);
}

.footer-link:hover::after {
  width: 100%;
}

/* 响应式设计 */
@media (max-width: 768px) {
  .footer-content {
    padding: 0 16px;
    font-size: 0.9rem;
  }
}
```

---

## 8. 配置示例

### 8.1 JSON 配置
```json
{
  "copyright": {
    "startDate": "2025-01-01",
    "autoRange": true
  },
  "footer": {
    "websiteText": "WEBSITE.GW124.TOP",
    "websiteUrl": "https://website.gw124.top",
    "authorText": "Wen",
    "authorUrl": "https://github.com/GWen124"
  }
}
```

### 8.2 YAML 配置
```yaml
copyright:
  startDate: "2025-01-01"
  autoRange: true

footer:
  websiteText: "WEBSITE.GW124.TOP"
  websiteUrl: "https://website.gw124.top"
  authorText: "Wen"
  authorUrl: "https://github.com/GWen124"
```

### 8.3 XML 配置
```xml
<?xml version="1.0" encoding="UTF-8"?>
<config>
  <copyright>
    <startDate>2025-01-01</startDate>
    <autoRange>true</autoRange>
  </copyright>
  <footer>
    <websiteText>WEBSITE.GW124.TOP</websiteText>
    <websiteUrl>https://website.gw124.top</websiteUrl>
    <authorText>Wen</authorText>
    <authorUrl>https://github.com/GWen124</authorUrl>
  </footer>
</config>
```

---

## 9. 测试用例

### 9.1 JavaScript 测试
```javascript
// tests/copyright.test.js
const CopyrightManager = require('../utils/copyrightManager')

describe('CopyrightManager', () => {
  test('应该正确计算年份范围', () => {
    const manager = new CopyrightManager('2020-01-01', true)
    const currentYear = new Date().getFullYear()
    
    if (currentYear > 2020) {
      expect(manager.getCopyrightYear()).toBe(`2020-${currentYear}`)
    } else {
      expect(manager.getCopyrightYear()).toBe('2020')
    }
  })

  test('应该只显示开始年份当autoRange为false', () => {
    const manager = new CopyrightManager('2020-01-01', false)
    expect(manager.getCopyrightYear()).toBe('2020')
  })

  test('应该处理无效日期', () => {
    const manager = new CopyrightManager('invalid-date', true)
    expect(() => manager.getCopyrightYear()).not.toThrow()
  })
})
```

### 9.2 Python 测试
```python
# tests/test_copyright_manager.py
import unittest
from datetime import datetime
from utils.copyright_manager import CopyrightManager

class TestCopyrightManager(unittest.TestCase):
    def test_copyright_year_range(self):
        manager = CopyrightManager('2020-01-01', True)
        current_year = datetime.now().year
        
        if current_year > 2020:
            self.assertEqual(manager.get_copyright_year(), f'2020-{current_year}')
        else:
            self.assertEqual(manager.get_copyright_year(), 2020)

    def test_copyright_year_single(self):
        manager = CopyrightManager('2020-01-01', False)
        self.assertEqual(manager.get_copyright_year(), 2020)

    def test_invalid_date(self):
        manager = CopyrightManager('invalid-date', True)
        # 应该不抛出异常
        self.assertIsNotNone(manager.get_copyright_year())
```

---

## 10. 部署说明

### 10.1 环境变量配置
```bash
# .env
COPYRIGHT_START_DATE=2025-01-01
COPYRIGHT_AUTO_RANGE=true
FOOTER_WEBSITE_TEXT=WEBSITE.GW124.TOP
FOOTER_WEBSITE_URL=https://website.gw124.top
FOOTER_AUTHOR_TEXT=Wen
FOOTER_AUTHOR_URL=https://github.com/GWen124
```

### 10.2 Docker 配置
```dockerfile
# Dockerfile
FROM node:18-alpine

WORKDIR /app
COPY package*.json ./
RUN npm install

COPY . .
EXPOSE 3000

CMD ["npm", "start"]
```

### 10.3 GitHub Actions 部署
```yaml
# .github/workflows/deploy.yml
name: Deploy Website Panel

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Install dependencies
      run: npm install
      
    - name: Build project
      run: npm run build
      
    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./dist
```

---

## 11. 最佳实践

### 11.1 性能优化
- 使用缓存避免重复计算
- 在服务端预计算版权年份
- 使用CDN缓存静态资源

### 11.2 安全考虑
- 验证输入日期格式
- 防止XSS攻击（转义HTML）
- 使用HTTPS链接

### 11.3 可访问性
- 添加适当的ARIA标签
- 确保颜色对比度符合WCAG标准
- 支持键盘导航

### 11.4 国际化
- 支持多语言版权文本
- 处理不同地区的日期格式
- 考虑时区问题

---

## 12. 常见问题

### 12.1 Q: 如何处理时区问题？
A: 使用UTC时间进行计算，避免时区差异导致的年份错误。

### 12.2 Q: 版权年份什么时候更新？
A: 通常在每年1月1日自动更新，也可以通过定时任务手动更新。

### 12.3 Q: 如何处理历史数据？
A: 保持历史版权信息不变，只更新当前年份。

### 12.4 Q: 多语言支持如何实现？
A: 使用国际化库（如i18n）处理不同语言的版权文本。

---

## 13. 更新日志

### v1.0.0 (2025-01-01)
- 初始版本发布
- 支持Vue、React、原生JS、PHP、Node.js、Python平台
- 实现自动年份范围计算
- 提供完整的测试用例

---

## 14. 许可证

MIT License

Copyright © 2025 Wen

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

---

## 15. 联系方式

- 作者：Wen
- GitHub：https://github.com/GWen124
- 网站：https://website.gw124.top

---

*本文档最后更新时间：2025-01-01*
